package model;

import java.sql.Connection;
import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class Reserves {

	Connection con;
	Integer huesped_id;
	Date fechaEntrada;
	Date fechaSalida;
	String valor;
	String formaPago;
	
	public Reserves(Connection con, Integer huesped_id, String fechaEntrada, String fechaSalida, String valor, String formaPago) {
		this.con = con;
		this.huesped_id = huesped_id;
		this.fechaEntrada = Date.valueOf(fechaEntrada);
		this.fechaSalida = Date.valueOf(fechaSalida);
		this.valor = valor;
		this.formaPago = formaPago;
	}
	
	public void makeReserve() throws SQLException {
		String statement = "INSERT INTO RESERVAS (huesped_id, fechaEntrada, fechaSalida, valor, formaPago) VALUES (?, ?, ?, ?, ?)";
		PreparedStatement stm = con.prepareStatement(statement, Statement.RETURN_GENERATED_KEYS);
		
		stm.setInt(1, huesped_id);
		stm.setDate(2, fechaEntrada);
		stm.setDate(3, fechaSalida);
		stm.setString(4, valor);
		stm.setString(5, formaPago);
		
		stm.execute();
		
		ResultSet rst = stm.getGeneratedKeys();
		while(rst.next()) {
			Integer id = rst.getInt(1);
			System.out.println("New reserve inserted with id = " + id);
		}
	}
}
