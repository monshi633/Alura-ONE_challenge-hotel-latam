package model;

import java.sql.Connection;
import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class Reserves {

	Connection con;

	public Reserves(Connection con) {
		this.con = con;
	}

	public void createReserve(Integer huespedId, String fechaEntrada, String fechaSalida, String valor,
			String formaPago) throws SQLException {
		// tengo que poner un try/catch por si el huespedId no existe
		String statement = "INSERT INTO reservas (huesped_id, fechaEntrada, fechaSalida, valor, formaPago) VALUES (?, ?, ?, ?, ?)";
		PreparedStatement stm = con.prepareStatement(statement, Statement.RETURN_GENERATED_KEYS);

		stm.setInt(1, huespedId);
		stm.setDate(2, Date.valueOf(fechaEntrada));
		stm.setDate(3, Date.valueOf(fechaSalida));
		stm.setString(4, valor);
		stm.setString(5, formaPago);
		stm.executeUpdate();

		ResultSet rst = stm.getGeneratedKeys();
		while (rst.next()) {
			Integer id = rst.getInt(1);
			System.out.println("New reserve inserted with id = " + id);
		}
	}

	public void readReserve(Integer id) throws SQLException {
		// Agregar try/catch por si no existe el id
		String statement = "SELECT * FROM reservas WHERE id = ?";
		PreparedStatement stm = con.prepareStatement(statement);

		stm.setInt(1, id);
		stm.execute();

		ResultSet rst = stm.executeQuery();
		while (rst.next()) {
			String huespedId = rst.getString("huesped_id");
			String fechaEntrada = rst.getString("fechaEntrada");
			String fechaSalida = rst.getString("fechaSalida");
			String valor = rst.getString("valor");
			String formaPago = rst.getString("formaPago");
			System.out.println("Reserve id: " + id + "\n"
					+ "Reserve huesped id: " + huespedId + "\n"
					+ "Reserve fecha de entrada: " + fechaEntrada + "\n"
					+ "Reserve fecha de salida: " + fechaSalida + "\n"
					+ "Reserve valor: " + valor + "\n"
					+ "Reserve forma de pago: " + formaPago);
		}
	}

	public void updateReserve() throws SQLException {

	}

	public void deleteReserve() throws SQLException {

	}

//	public void makeReserve() throws SQLException {
//		Integer huesped_id;
//		Date fechaEntrada;
//		Date fechaSalida;
//		String valor;
//		String formaPago;
//
//		this.huesped_id = huesped_id;
//		this.fechaEntrada = Date.valueOf(fechaEntrada);
//		this.fechaSalida = Date.valueOf(fechaSalida);
//		this.valor = valor;
//		this.formaPago = formaPago;
//
//		String statement = "INSERT INTO RESERVAS (huesped_id, fechaEntrada, fechaSalida, valor, formaPago) VALUES (?, ?, ?, ?, ?)";
//		PreparedStatement stm = con.prepareStatement(statement, Statement.RETURN_GENERATED_KEYS);
//
//		stm.setInt(1, huesped_id);
//		stm.setDate(2, fechaEntrada);
//		stm.setDate(3, fechaSalida);
//		stm.setString(4, valor);
//		stm.setString(5, formaPago);
//
//		stm.execute();
//
//		ResultSet rst = stm.getGeneratedKeys();
//		while (rst.next()) {
//			Integer id = rst.getInt(1);
//			System.out.println("New reserve inserted with id = " + id);
//		}
//	}
}
